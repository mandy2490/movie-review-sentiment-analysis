Movie Review Sentiment Analysis on GCP

An end-to-end Machine Learning pipeline that classifies movie reviews as Positive or Negative. This project demonstrates a hybrid workflow using **Jupyter Notebooks** for training and a **Python script** for batch predictions in production, fully integrated with **Google Cloud Platform (BigQuery & Cloud Storage)**.

## Project Overview

This system reads raw movie reviews from Google BigQuery, processes the text using NLP techniques, and predicts sentiment using a Logistic Regression model.

* **Training:** Performed in a local Jupyter Notebook (`training_pipeline.ipynb`).
* **Model Storage:** Artifacts are versioned and stored in **Google Cloud Storage (GCS)**.
* **Inference:** A standalone script (`main.py`) fetches new data from BigQuery, predicts sentiment, and writes results back to the database.

---

## Repository Structure

├── training_pipeline.ipynb   # 1. Loads data, trains model, saves .joblib files, uploads to GCS.
├── main.py                   # 2. Production script. Downloads model, fetches BQ data, predicts & updates.
├── requirements.txt          #    Python dependencies.
└── README.md                 #    Project documentation.
└── sentoment_model_assests   # contains the model artifacts  



Architecture & Workflow
1. Model Training (training_pipeline.ipynb)
The notebook handles the "Data Science" portion of the lifecycle:

Ingestion: Fetches labeled training data from BigQuery.

Preprocessing: Cleans text (removes HTML, URLs, punctuation, stop words).

Vectorization: Converts text to numbers using TfidfVectorizer (10k features).

Modeling: Trains a Logistic Regression classifier (Accuracy: ~86%).

Deployment: Serializes the model and vectorizer (.joblib) and uploads them to a GCS Bucket.

2. Batch Prediction (main.py)
The script handles the "Data Engineering" portion:

Setup: Downloads the latest model.joblib and vectorizer.joblib from GCS.

Extraction: Queries BigQuery for rows where predicted_sentiment IS NULL.

Processing: Applies the exact same text cleaning logic used in training.

Prediction: Generates predictions (0 or 1).

Load: Updates the BigQuery table using a MERGE statement to fill in the missing predictions.


Future Improvements:-

Add Airflow or Cloud Scheduler to run main.py automatically every night.

Implement MLflow for better experiment tracking.

Upgrade to a Transformer model (BERT/RoBERTa) for higher accuracy.



## Analytics Dashboard

Once the `main.py` script has populated the predictions, you can create a real-time "Leaderboard" view in BigQuery. This aggregates the sentiment scores by movie and director to calculate an approval rating.

### Create the View
Run the following SQL query in your BigQuery console to create the `movie_leaderboard_view`:

```sql
CREATE OR REPLACE VIEW `your_project_id.movie_review.movie_leaderboard_view` AS
SELECT
    movie_id,
    movie_title,
    director_name,
    COUNT(*) AS total_reviews,
    COUNTIF(predicted_sentiment = 1) AS positive_reviews,
    COUNTIF(predicted_sentiment = 0) AS negative_reviews,
    ROUND(AVG(predicted_sentiment) * 100, 1) AS approval_score,
    ROUND(1 + (4 * AVG(predicted_sentiment)), 1) AS avg_stars
FROM
    `your_project_id.movie_review.reviews_movie_info`
WHERE
    predicted_sentiment IS NOT NULL
GROUP BY
    movie_id,
    movie_title,
    director_name
ORDER BY
    approval_score DESC;
Sample Output-
### Sample Output
You can now query this view to see the top-rated movies. Here is an example of the actual data generated by the pipeline:

| movie_id | movie_title | director_name | total_reviews | positive_reviews | negative_reviews | approval_score | avg_stars |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 38954 | Amélie | Jean-Pierre Jeunet | 5 | 3 | 2 | 60.0% | 3.4 |
| 5992 | The Wandering Earth 2 | Frant Gwo | 6 | 3 | 3 | 50.0% | 3.0 |
| 21381 | Oppenheimer | Christopher Nolan | 8 | 4 | 4 | 50.0% | 3.0 |
| 32173 | Barbie | Greta Gerwig | 7 | 3 | 4 | 42.9% | 2.7 |
| 8350 | Wadjda | Haifaa al-Mansour | 5 | 2 | 3 | 40.0% | 2.6 |
| 93074 | Jawan | Atlee | 8 | 3 | 5 | 37.5% | 2.5 |
| 32976 | Parasite | Bong Joon-ho | 7 | 2 | 5 | 28.6% | 2.1 |
| 38292 | Everything Everywhere All at Once | Daniels | 4 | 1 | 3 | 25.0% | 2.0 |

